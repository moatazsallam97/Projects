/**********************************************************************************************************************
 *  FILE DESCRIPTION
 *  -----------------------------------------------------------------------------------------------------------------*/
/**        \file  Systick.c
 *        \brief  System Timer Controller Driver
 *
 *      \details  The Driver Configure All System Timer Registers
 *
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  INCLUDES
 *********************************************************************************************************************/

#include "Systick.h"


/**********************************************************************************************************************
*  LOCAL MACROS CONSTANT\FUNCTION
*********************************************************************************************************************/	


/**********************************************************************************************************************
 *  LOCAL DATA 
 *********************************************************************************************************************/

SysTick_CB_Type SysTick_CbPtr;                    

/**********************************************************************************************************************
 *  GLOBAL DATA
 *********************************************************************************************************************/
 

/**********************************************************************************************************************
 *  LOCAL FUNCTION PROTOTYPES
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  LOCAL FUNCTIONS
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  GLOBAL FUNCTIONS
 *********************************************************************************************************************/

/******************************************************************************
* \Syntax          : void Register_SysTick(SysTick_CB_Type Ptr);
* \Description     : Register a function to the SysTick ISR                                                                                                             
* \Sync\Async      : Synchronous                                               
* \Reentrancy      : Non Reentrant                                             
* \Parameters (in) : SysTick_CB_Type Ptr                    
* \Parameters (out): None                                                      
* \Return value:   : None
*******************************************************************************/
void Register_SysTick(SysTick_CB_Type Ptr){
	if (Ptr != NULL_PTR){
		SysTick_CbPtr = Ptr;
	}
}

/******************************************************************************
* \Syntax          : void SysTick_Handler(void)
* \Description     : SysTick ISR                                                                                                           
* \Sync\Async      : Synchronous                                               
* \Reentrancy      : Non Reentrant                                             
* \Parameters (in) : None                   
* \Parameters (out): None                                                      
* \Return value:   : None
*******************************************************************************/
void SysTick_Handler(void){
	if (SysTick_CbPtr != NULL_PTR){
		SysTick_CbPtr();
	}
}


/******************************************************************************
* \Syntax          : void Systick_Init(Systick_ConfigType Config);                                      
* \Description     : initialize System Timer                                                                                                              
* \Sync\Async      : Synchronous                                               
* \Reentrancy      : Non Reentrant                                             
* \Parameters (in) : Systick_ConfigType Config                     
* \Parameters (out): None                                                      
* \Return value:   : None
*******************************************************************************/
void Systick_Init(Systick_ConfigType Config){
    STCURRENT = 0xFF;                               // Clearing STCURRENT register.

    switch (Config.Source){                         //
        case SCLKSource_PIOSC:
            STCTRL &= ~(1 << SYSCLK_SRC);                  
            break;
        case SCLKSource_SystemClock:                //   Clock Source Selection  //
            STCTRL |= (1 << SYSCLK_SRC);
            break;
        default:
            break;                                                               //
    }

    switch (Config.IntType){                        //
        case SystickInt_Enabled:
            STCTRL |= (1 << SYSINTEN);
            break;
        case SystickInt_Disalbed:                   //  Interrupt Type Selection //
            STCTRL &= ~(1 << SYSINTEN);
            break;
        default:
            break;                                                                //
    }
}


/**********************************************************************************************************************
 *  END OF FILE: Systick.c
 *********************************************************************************************************************/
